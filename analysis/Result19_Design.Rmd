---
title: "Result3_Design"
output:
  workflowr::wflow_html:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The experiment is based on the following simulation setting.

### Experiment setting

We consider several design matrices and corresponding signals, reported by other papers as "hard".

(1) `LowdimIndepGauss + SuBogdanCandes`: We consider the case reported by [False discoveries occur early on the Lasso path](https://projecteuclid.org/euclid.aos/1509436830).

We sample the standard i.i.d. Gaussian measurement $X_{ij} \sim N(0,1)$ anda construct $X \in \mathbb{R}^p$ with $n = 1010$ and $p = 1000$. The signal is $\beta_j = M$ for $j \in J_1$ and $\beta_j = 1/M$ for $j \in J_2$, where $J_1$ and $J_2$ are mutually exclusive random subset of $\{1,\cdots,p\}$ of size $10$ and $90$, respectively. Otherwise $\beta_j = 0$. $M = 1000$ is very large positive constant, and we fix $\sigma^2 = 1$. Thus PVE will be very close to 1.

(2) `RealGenotype + PointNormal`. We use 20 real genotype matrices from GTEx consortium (https://gtexportal.org/home/). Each design matrix is very high-dimensional, $n = 287$ and $p = 5732, 7659, 6857, 4012, 6356, 8683, 4076, 7178, 4847, 5141, 6535, 7537, 7263, 7011, 7468, 5020, 8760, 5995, 6440, 5456$. The number of coefficients $p$ varies from 4,012 to 8,760. The average size of $p$ is 6,401.3. Also, columns of $X$ are very highly correlated (even some are perfectly correlated).

(3) `EquiCorrGauss + PointNormal`:

(4) `LocalCorrGauss + PointNormal`:

(5) `Changepoint + BigSuddenChange`:

(6) `Changepoint + OneSmallChange`: 

## Results

```{r}
res.pred = rbind(
colMeans(matrix(readRDS("results/subogdancandes.RDS")[[1]]$pred, 20, 13)),
colMeans(matrix(readRDS("results/realgenotype.RDS")$pred, 20, 13)),
colMeans(matrix(readRDS("results/equicorr.RDS")[[4]]$pred, 20, 13)),
colMeans(matrix(readRDS("results/localcorr.RDS")[[3]]$pred, 20, 13)),
colMeans(matrix(readRDS("results/changepoint1.RDS")[[2]]$pred, 20, 13)),
colMeans(matrix(readRDS("results/changepoint2.RDS")[[1]]$pred, 20, 13)))

res.time = res = rbind(
colMeans(matrix(readRDS("results/subogdancandes.RDS")[[1]]$time, 20, 13)),
colMeans(matrix(readRDS("results/realgenotype.RDS")$time, 20, 13)),
colMeans(matrix(readRDS("results/equicorr.RDS")[[4]]$time, 20, 13)),
colMeans(matrix(readRDS("results/localcorr.RDS")[[3]]$time, 20, 13)),
colMeans(matrix(readRDS("results/changepoint1.RDS")[[2]]$time, 20, 13)),
colMeans(matrix(readRDS("results/changepoint2.RDS")[[1]]$time, 20, 13)))

saveRDS(list(pred = res.pred, time = res.time), "results/design.RDS")
```
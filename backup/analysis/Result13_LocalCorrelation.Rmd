---
title: "Result10_Correlation"
output:
  workflowr::wflow_html:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The experiment is based on the following simulation setting.

### Design setting

We sample the equicorrelated Gaussian measurement $X_{ij} \sim N(0,\Sigma)$ where $\Sigma$ has diagonal entries $1$ and off-diagonal entries $\rho$. 

The we construct $X \in \mathbb{R}^p$ with $n = 500$ and $p = 2000$.

### Signal setting

We sample the i.i.d. normal coefficients $\beta_j \sim N(0,\sigma_\beta^2)$ for $j \in J$ and $\beta_ j = 0$ otherwise, where $J$ is a set of randomly $s$ indices in $\{1,â‹¯,p\}$c hosen uniformly at random.

This signal will be called `pointnormal`. We fix $s = 20$.

### PVE

We fix PVE = 0.5.

### Packages / Libraries

A list of packages we have loaded is collapsed. Please click "code" to see the list.

```{r library, message = FALSE}
library(Matrix); library(ggplot2); library(cowplot); library(susieR); library(BGLR);
library(glmnet); library(mr.ash.alpha); library(ncvreg); library(L0Learn); library(varbvs); library(mvtnorm)
standardize = FALSE
source('code/method_wrapper.R')
source('code/sim_wrapper.R')
```

## Results

The result is summarized below. 

```{r fig1.1, fig.height=13, fig.width=15}
res_df       = readRDS("../results/localcorrfdr50020020.RDS")
method_list  = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge","SCAD","MCP","L0Learn",
                 "Mr.ASH.order","Mr.ASH.init")
method_level = c("Mr.ASH","Mr.ASH.order","Mr.ASH.init","E-NET","Lasso","Ridge",
                 "SCAD","MCP","L0Learn",
                 "VarBVS","BayesB","Blasso","SuSiE")
col          = gg_color_hue(13)[c(1,12,13,2:11)]
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
a            = c(1,2,3,4,5,6)
out = matrix(0,6,13)
for (i in 1:6) {
  out[i,] = colMeans(matrix(res_df[[a[i]]]$pred, 20, 13))
}
colnames(out) = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge",
                  "SCAD","MCP","L0Learn",
                  "Mr.ASH.order",
                  "Mr.ASH.init")
ind = c(1,6:13)
out = out[,ind]

col   = gg_color_hue(13)[c(1:7,12,13)]
shape = c(19,17,24,25,9,3,11,4,5,7,8,10,1)[c(1:7,12,13)]
df = data.frame(x = rep(1:length(rho_list),length(ind)), rho = rep(rho_list, length(ind)),
                pred = c(out), fit = rep(colnames(out), each = length(rho_list)))
df$fit = factor(df$fit, levels =  c("Mr.ASH","E-NET","Lasso","Ridge",
                                    "SCAD","MCP","L0Learn","E-NET2","Lasso2","Ridge2",
                                    "VarBVS","BayesB","Blasso","SuSiE",
                                    "Mr.ASH.order",
                                    "Mr.ASH.init"))
df$size = 0.5
df$size[1:length(rho_list)] = 1.2
df$lt = "solid"
df$lt[43:48] = "dashed"
fig_dummy = ggplot(df) + geom_line(aes(x = x, y = pred, color = fit), size = df$size, linetype = df$lt) +
  geom_point(aes(x = x, y = pred, color = fit, shape = fit), size = 2.5) +
  theme_cowplot(font_size = 14) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6),
                     labels = c("0","0.3","0.6","0.9","0.95","0.99")) +
  labs(y = "predictior error (rmse / sigma)", x = "correlation across columns of X (rho)") +
  theme(axis.line = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values = col) +
  scale_shape_manual(values = shape) +
  scale_y_continuous(trans = "log10", breaks = c(1,1.05,1.1,1.15,1.2,1.25,1.3,1.4)) +
  coord_cartesian(ylim = c(1,1.3))
p1        = fig_dummy + theme(legend.position = "none")
fig_main  = p1
subtitle  = ggdraw() + draw_label("Scenario: EquiCorrGauss + Normal, n = 500, p = 200, s = 20, pve = 0.5", fontface  = 'bold', size = 14) 
fig1.1      = plot_grid(subtitle,fig_dummy, ncol = 1, rel_heights = c(0.05,0.95))
```

```{r fig1.2, fig.height=13, fig.width=15}
res_df       = readRDS("../results/localcorr50020020.RDS")
method_list  = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge","SCAD","MCP","L0Learn",
                 "Mr.ASH.order","Mr.ASH.init")
method_level = c("Mr.ASH","Mr.ASH.order","Mr.ASH.init","E-NET","Lasso","Ridge",
                 "SCAD","MCP","L0Learn",
                 "VarBVS","BayesB","Blasso","SuSiE")
col          = gg_color_hue(13)[c(1,12,13,2:11)]
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
a            = c(1,2,3,4,5,6)
out = matrix(0,6,13)
for (i in 1:6) {
  out[i,] = colMeans(matrix(res_df[[a[i]]]$pred, 20, 13))
}
colnames(out) = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge",
                  "SCAD","MCP","L0Learn",
                  "Mr.ASH.order",
                  "Mr.ASH.init")
ind = c(1:5,12,13)
out = out[,ind]

col   = gg_color_hue(13)[c(1,8:13)]
shape = c(19,17,24,25,9,3,11,4,5,7,8,10,1)[c(1,8:13)]
df = data.frame(x = rep(1:length(rho_list),length(ind)), rho = rep(rho_list, length(ind)),
                pred = c(out), fit = rep(colnames(out), each = length(rho_list)))
df$fit = factor(df$fit, levels =  c("Mr.ASH","E-NET","Lasso","Ridge",
                                    "SCAD","MCP","L0Learn","E-NET2","Lasso2","Ridge2",
                                    "VarBVS","BayesB","Blasso","SuSiE",
                                    "Mr.ASH.order",
                                    "Mr.ASH.init"))
df$size = 0.5
df$size[1:length(rho_list)] = 1.2
df$lt = "solid"
df$lt[31:36] = "dashed"
fig_dummy = ggplot(df) + geom_line(aes(x = x, y = pred, color = fit), size = df$size, linetype = df$lt) +
  geom_point(aes(x = x, y = pred, color = fit, shape = fit), size = 2.5) +
  theme_cowplot(font_size = 14) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6),
                     labels = c("0","0.3","0.6","0.9","0.95","0.99")) +
  labs(y = "predictior error (rmse / sigma)", x = "correlation across columns of X (rho)") +
  theme(axis.line = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values = col) +
  scale_shape_manual(values = shape) +
  scale_y_continuous(trans = "log10", breaks = c(1,1.05,1.1,1.15,1.2,1.25,1.3,1.4)) +
  coord_cartesian(ylim = c(1,1.3))
p1        = fig_dummy + theme(legend.position = "none")
fig_main  = p1
subtitle  = ggdraw() + draw_label("Scenario: EquiCorrGauss + Normal, n = 500, p = 200, s = 20, pve = 0.5", fontface  = 'bold', size = 14) 
fig1.2      = plot_grid(subtitle,fig_dummy, ncol = 1, rel_heights = c(0.05,0.95))
```

```{r fig1.3}
res_df       = readRDS("../results/localcorrfdr50020020.RDS")
method_list  = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge","SCAD","MCP","L0Learn",
                 "Mr.ASH.order","Mr.ASH.init")
method_level = c("Mr.ASH","Mr.ASH.order","Mr.ASH.init","E-NET","Lasso","Ridge",
                 "SCAD","MCP","L0Learn",
                 "VarBVS","BayesB","Blasso","SuSiE")
col          = gg_color_hue(13)[c(1,12,13,2:11)]
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
a            = c(1,2,3,4,5,6)
out = matrix(0,6,13)
for (i in 1:6) {
  out[i,] = colMeans(matrix(res_df[[a[i]]]$fdp, 20, 13))
}
colnames(out) = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge",
                  "SCAD","MCP","L0Learn",
                  "Mr.ASH.order",
                  "Mr.ASH.init")
ind = c(1,6:13)
out = out[,ind]

col   = gg_color_hue(13)[c(1:7,12,13)]
shape = c(19,17,24,25,9,3,11,4,5,7,8,10,1)[c(1:7,12,13)]
df = data.frame(x = rep(1:length(rho_list),length(ind)), rho = rep(rho_list, length(ind)),
                pred = c(out), fit = rep(colnames(out), each = length(rho_list)))
df$fit = factor(df$fit, levels =  c("Mr.ASH","E-NET","Lasso","Ridge",
                                    "SCAD","MCP","L0Learn","E-NET2","Lasso2","Ridge2",
                                    "VarBVS","BayesB","Blasso","SuSiE",
                                    "Mr.ASH.order",
                                    "Mr.ASH.init"))
df$size = 0.5
df$size[1:length(rho_list)] = 1.2
df$lt = "solid"
df$lt[43:48] = "dashed"
fig_dummy = ggplot(df) + geom_line(aes(x = x, y = pred, color = fit), size = df$size, linetype = df$lt) +
  geom_point(aes(x = x, y = pred, color = fit, shape = fit), size = 2.5) +
  theme_cowplot(font_size = 14) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6),
                     labels = c("0","0.3","0.6","0.9","0.95","0.99")) +
  labs(y = "predictior error (rmse / sigma)", x = "correlation across columns of X (rho)") +
  theme(axis.line = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values = col) +
  scale_shape_manual(values = shape) +
  coord_cartesian(ylim = c(0,1))
p1        = fig_dummy + theme(legend.position = "none")
fig_main  = p1
subtitle  = ggdraw() + draw_label("Scenario: EquiCorrGauss + Normal, n = 500, p = 200, s = 20, pve = 0.5", fontface  = 'bold', size = 14) 
fig1.3      = plot_grid(subtitle,fig_dummy, ncol = 1, rel_heights = c(0.05,0.95))
```

```{r fig2.1, fig.height=13, fig.width=15}
res_df       = readRDS("../results/localcorr500200020.RDS")
method_list  = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge","SCAD","MCP","L0Learn",
                 "Mr.ASH.order","Mr.ASH.init")
method_level = c("Mr.ASH","Mr.ASH.order","Mr.ASH.init","E-NET","Lasso","Ridge",
                 "SCAD","MCP","L0Learn",
                 "VarBVS","BayesB","Blasso","SuSiE")
col          = gg_color_hue(13)[c(1,12,13,2:11)]
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
a            = c(1,2,3,4,5,6)
out = matrix(0,6,13)
for (i in 1:6) {
  out[i,] = colMeans(matrix(res_df[[a[i]]]$pred, 20, 13))
}
colnames(out) = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge",
                  "SCAD","MCP","L0Learn",
                  "Mr.ASH.order",
                  "Mr.ASH.init")
ind = c(1,6:13)
out = out[,ind]

col   = gg_color_hue(13)[c(1:7,12,13)]
shape = c(19,17,24,25,9,3,11,4,5,7,8,10,1)[c(1:7,12,13)]
df = data.frame(x = rep(1:length(rho_list),length(ind)), rho = rep(rho_list, length(ind)),
                pred = c(out), fit = rep(colnames(out), each = length(rho_list)))
df$fit = factor(df$fit, levels =  c("Mr.ASH","E-NET","Lasso","Ridge",
                                    "SCAD","MCP","L0Learn","E-NET2","Lasso2","Ridge2",
                                    "VarBVS","BayesB","Blasso","SuSiE",
                                    "Mr.ASH.order",
                                    "Mr.ASH.init"))
df$size = 0.5
df$size[1:length(rho_list)] = 1.2
df$lt = "solid"
df$lt[43:48] = "dashed"
fig_dummy = ggplot(df) + geom_line(aes(x = x, y = pred, color = fit), size = df$size, linetype = df$lt) +
  geom_point(aes(x = x, y = pred, color = fit, shape = fit), size = 2.5) +
  theme_cowplot(font_size = 14) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6),
                     labels = c("0","0.3","0.6","0.9","0.95","0.99")) +
  labs(y = "predictior error (rmse / sigma)", x = "correlation across columns of X (rho)") +
  theme(axis.line = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values = col) +
  scale_shape_manual(values = shape) +
  scale_y_continuous(trans = "log10", breaks = c(1,1.05,1.1,1.15,1.2,1.3,1.4)) +
  coord_cartesian(ylim = c(1,1.3))
p1        = fig_dummy + theme(legend.position = "none")
fig_main  = p1
subtitle  = ggdraw() + draw_label("Scenario: EquiCorrGauss + Normal, n = 500, p = 2000, s = 20, pve = 0.5", fontface  = 'bold', size = 14) 
fig2.1      = plot_grid(subtitle,fig_dummy, ncol = 1, rel_heights = c(0.05,0.95))
```

```{r fig2.2, fig.height=13, fig.width=15}
res_df       = readRDS("../results/localcorr500200020.RDS")
method_list  = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge","SCAD","MCP","L0Learn",
                 "Mr.ASH.order","Mr.ASH.init")
method_level = c("Mr.ASH","Mr.ASH.order","Mr.ASH.init","E-NET","Lasso","Ridge",
                 "SCAD","MCP","L0Learn",
                 "VarBVS","BayesB","Blasso","SuSiE")
col          = gg_color_hue(13)[c(1,12,13,2:11)]
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
a            = c(1,2,3,4,5,6)
out = matrix(0,6,13)
for (i in 1:6) {
  out[i,] = colMeans(matrix(res_df[[a[i]]]$pred, 20, 13))
}
colnames(out) = c("Mr.ASH","VarBVS","BayesB","Blasso","SuSiE","E-NET","Lasso","Ridge",
                  "SCAD","MCP","L0Learn",
                  "Mr.ASH.order",
                  "Mr.ASH.init")
ind = c(1:5,12,13)
out = out[,ind]

col   = gg_color_hue(13)[c(1,8:13)]
shape = c(19,17,24,25,9,3,11,4,5,7,8,10,1)[c(1,8:13)]
df = data.frame(x = rep(1:length(rho_list),length(ind)), rho = rep(rho_list, length(ind)),
                pred = c(out), fit = rep(colnames(out), each = length(rho_list)))
df$fit = factor(df$fit, levels =  c("Mr.ASH","E-NET","Lasso","Ridge",
                                    "SCAD","MCP","L0Learn","E-NET2","Lasso2","Ridge2",
                                    "VarBVS","BayesB","Blasso","SuSiE",
                                    "Mr.ASH.order",
                                    "Mr.ASH.init"))
df$size = 0.5
df$size[1:length(rho_list)] = 1.2
df$lt = "solid"
df$lt[31:36] = "dashed"
fig_dummy = ggplot(df) + geom_line(aes(x = x, y = pred, color = fit), size = df$size, linetype = df$lt) +
  geom_point(aes(x = x, y = pred, color = fit, shape = fit), size = 2.5) +
  theme_cowplot(font_size = 14) +
  scale_x_continuous(breaks = c(1,2,3,4,5,6),
                     labels = c("0","0.3","0.6","0.9","0.95","0.99")) +
  labs(y = "predictior error (rmse / sigma)", x = "correlation across columns of X (rho)") +
  theme(axis.line = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values = col) +
  scale_shape_manual(values = shape) +
  scale_y_continuous(trans = "log10", breaks = c(1,1.05,1.1,1.15,1.2,1.3,1.4)) +
  coord_cartesian(ylim = c(1,1.3))
p1        = fig_dummy + theme(legend.position = "none")
fig_main  = p1
subtitle  = ggdraw() + draw_label("Scenario: EquiCorrGauss + Normal, n = 500, p = 2000, s = 20, pve = 0.5", fontface  = 'bold', size = 14) 
fig2.2      = plot_grid(subtitle,fig_dummy, ncol = 1, rel_heights = c(0.05,0.95))
```

## Source code

The source code will be popped up when you click `code` on the right side. 

```{r code2}
tdat2        = list()
n            = 500
p            = 2000
s            = 20
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
method_list  = c("varbvs","bayesb","blasso","susie","enet","lasso","ridge","scad2","mcp2","l0learn")
method_list2 = c("mr.ash", method_list, "mr.ash.order", "mr.ash.init")
method_num   = length(method_list2)
iter_num     = 20
pred         = matrix(0, iter_num, method_num); colnames(pred) = method_list2
time         = matrix(0, iter_num, method_num); colnames(time) = method_list2
fdp          = matrix(0, iter_num, method_num); colnames(fdp) = method_list2
pow          = matrix(0, iter_num, method_num); colnames(pow) = method_list2


for (iter in 6:1) {
rho        = rho_list[iter]
Sigma.sqrt = matrix(0,p,p)
for (j in 0:round(-2/log(rho))) {
  for (jj in 1:(p-j)) {
    Sigma.sqrt[jj,jj+j] = rho^j
    Sigma.sqrt[jj+j,jj] = rho^j
  }
}
for (i in 1:20) {
  data          = simulate_data(n, p, s = s, seed = i, signal = "normal", rho = rho,
                                design = "localcorrgauss", Sigma.sqrt = Sigma.sqrt, pve = 0.5)
 
  true_support  = (data$beta != 0)
 
  for (j in 1:length(method_list)) {
    fit.method    = get(paste("fit.",method_list[j],sep = ""))
    fit           = fit.method(data$X, data$y, data$X.test, data$y.test, seed = i)
    pred[i,j+1]   = fit$rsse / data$sigma / sqrt(n)
    time[i,j+1]   = fit$t
    if (method_list[j] %in% c("varbvs","bayesb","susie")) {
      discoveries       = (fit$pip > 0.5)
    } else {
      discoveries       = (fit$beta != 0)
    }
    fdp[i,j+1]    = compute_fdp(discoveries, true_support)
    pow[i,j+1]    = compute_pow(discoveries, true_support)
    
    if (method_list[j] == "lasso") {
      lasso.path.order = mr.ash.alpha:::path.order(fit$fit$glmnet.fit)
      lasso.beta       = as.vector(coef(fit$fit))[-1]
      lasso.time       = c(fit$t, fit$t2)
    }
  }
 
  fit         = fit.mr.ash(data$X, data$y, data$X.test, data$y.test, seed = i,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,1]   = fit$rsse / data$sigma / sqrt(n)
  time[i,1]   = fit$t
  discoveries = (fit$pip > 0.5)
  fdp[i,1]    = compute_fdp(discoveries, true_support)
  pow[i,1]    = compute_pow(discoveries, true_support)
  
  fit         = fit.mr.ash2(data$X, data$y, data$X.test, data$y.test, seed = i,
                            update.order = lasso.path.order,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,j+2] = fit$rsse / data$sigma / sqrt(n)
  time[i,j+2] = fit$t + lasso.time[2]
  discoveries = (fit$pip > 0.5)
  fdp[i,j+2]  = compute_fdp(discoveries, true_support)
  pow[i,j+2]  = compute_pow(discoveries, true_support)
  
  fit         = fit.mr.ash2(data$X, data$y, data$X.test, data$y.test, seed = i,
                            beta.init = lasso.beta,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,j+3] = fit$rsse / data$sigma / sqrt(n)
  time[i,j+3] = fit$t + lasso.time[1]
  discoveries = (fit$pip > 0.5)
  fdp[i,j+3]  = compute_fdp(discoveries, true_support)
  pow[i,j+3]  = compute_pow(discoveries, true_support)
  
  print(c(fdp[i,]))
  print(c(pow[i,]))
}
tdat2[[iter]] = data.frame(pred = c(pred), time = c(time), fdp = c(fdp),
                           pow = c(pow), fit = rep(method_list2, each = 20))
}
```

```{r code, eval = FALSE}
tdat1        = list()
n            = 500
p            = 200
s            = 20
rho_list     = c(0,0.3,0.6,0.9,0.95,0.99)
method_list  = c("varbvs","bayesb","blasso","susie","enet","lasso","ridge","scad2","mcp2","l0learn")
method_list2 = c("mr.ash", method_list, "mr.ash.order", "mr.ash.init")
method_num   = length(method_list2)
iter_num     = 20
pred         = matrix(0, iter_num, method_num); colnames(pred) = method_list2
time         = matrix(0, iter_num, method_num); colnames(time) = method_list2
fdp          = matrix(0, iter_num, method_num); colnames(fdp) = method_list2
pow          = matrix(0, iter_num, method_num); colnames(pow) = method_list2


for (iter in 1:6) {
rho        = rho_list[iter]
Sigma.sqrt = matrix(0,p,p)
for (j in 0:round(-2/log(rho))) {
  for (jj in 1:(p-j)) {
    Sigma.sqrt[jj,jj+j] = rho^j
    Sigma.sqrt[jj+j,jj] = rho^j
  }
}
for (i in 1:20) {
  data          = simulate_data(n, p, s = s, seed = i, signal = "normal", rho = rho,
                                design = "localcorrgauss", Sigma.sqrt = Sigma.sqrt, pve = 0.5)
  true_support  = (data$beta != 0)
 
  for (j in 1:length(method_list)) {
    fit.method    = get(paste("fit.",method_list[j],sep = ""))
    fit           = fit.method(data$X, data$y, data$X.test, data$y.test, seed = i)
    pred[i,j+1]   = fit$rsse / data$sigma / sqrt(n)
    time[i,j+1]   = fit$t
    if (method_list[j] %in% c("varbvs","bayesb","susie")) {
      discoveries       = (fit$pip > 0.5)
    } else {
      discoveries       = (fit$beta != 0)
    }
    fdp[i,j+1]    = compute_fdp(discoveries, true_support)
    pow[i,j+1]    = compute_pow(discoveries, true_support)
    
    if (method_list[j] == "lasso") {
      lasso.path.order = mr.ash.alpha:::path.order(fit$fit$glmnet.fit)
      lasso.beta       = as.vector(coef(fit$fit))[-1]
      lasso.time       = c(fit$t, fit$t2)
    }
  }
 
  fit         = fit.mr.ash(data$X, data$y, data$X.test, data$y.test, seed = i,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,1]   = fit$rsse / data$sigma / sqrt(n)
  time[i,1]   = fit$t
  discoveries = (fit$pip > 0.5)
  fdp[i,1]    = compute_fdp(discoveries, true_support)
  pow[i,1]    = compute_pow(discoveries, true_support)
  
  fit         = fit.mr.ash2(data$X, data$y, data$X.test, data$y.test, seed = i,
                            update.order = lasso.path.order,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,j+2] = fit$rsse / data$sigma / sqrt(n)
  time[i,j+2] = fit$t + lasso.time[2]
  discoveries = (fit$pip > 0.5)
  fdp[i,j+2]  = compute_fdp(discoveries, true_support)
  pow[i,j+2]  = compute_pow(discoveries, true_support)
  
  fit         = fit.mr.ash2(data$X, data$y, data$X.test, data$y.test, seed = i,
                            beta.init = lasso.beta,
                           sa2 = (2^((0:19) / 5) - 1)^2)
  pred[i,j+3] = fit$rsse / data$sigma / sqrt(n)
  time[i,j+3] = fit$t + lasso.time[1]
  discoveries = (fit$pip > 0.5)
  fdp[i,j+3]  = compute_fdp(discoveries, true_support)
  pow[i,j+3]  = compute_pow(discoveries, true_support)
  
  print(c(fdp[i,]))
  print(c(pow[i,]))
}
tdat1[[iter]] = data.frame(pred = c(pred), time = c(time), fdp = c(fdp),
                           pow = c(pow), fit = rep(method_list2, each = 20))
}
```

## System Configuration

Click the below Session Info.